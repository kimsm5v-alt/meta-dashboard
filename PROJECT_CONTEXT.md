# PROJECT_CONTEXT.md - META 프로젝트 전체 컨텍스트

> ⚠️ **Claude Code 필독**: 이 파일은 프로젝트의 모든 배경지식을 담고 있습니다.
> 작업 전 반드시 이 파일과 `docs/` 폴더를 먼저 읽어주세요.

---

## 1. 프로젝트 개요

### 1.1 프로젝트명
**META 학습심리정서검사 AI 에이전트 대시보드**

### 1.2 목적
교사가 학생들의 학습심리정서검사(META) 결과를 쉽게 분석하고, AI 기반 맞춤형 코칭 전략을 제공받아 학생 상담 및 학급 운영에 활용할 수 있도록 지원

### 1.3 타겟 사용자
- 초등학교 담임교사
- 중학교 담임교사
- (향후) 학부모, 상담사

### 1.4 연동 플랫폼
- **비바샘**: 천재교육의 교사용 플랫폼 (메인 컬러: #3351A4)

---

## 2. META 학습종합검사 이해

### 2.1 검사 개요

| 항목 | 내용 |
|------|------|
| 검사명 | META 학습심리정서검사 |
| 대상 | 초등학생, 중학생 |
| 문항 수 | 124문항 |
| 측정 요인 | 38개 |
| 검사 차수 | 연 2회 (1차: 3월, 2차: 9월) |
| 결과 형태 | T점수 (평균 50, 표준편차 10) |

### 2.2 검사 구조 (5대 영역 → 11개 중분류 → 38개 요인)

```
META 학습심리정서검사
│
├── 자아 강점 (긍정적 자원)
│   ├── 긍정적 자아: 자기존중감, 자기효능감, 성장마인드셋
│   └── 대인관계능력: 자기정서인식, 자기정서조절, 타인정서인식, 타인공감능력
│
├── 학습 디딤돌 (학습 촉진 요인)
│   ├── 메타인지: 계획능력, 점검능력, 조절능력
│   ├── 학습기술: 공부환경, 시간관리, 수업태도, 노트하기, 시험준비
│   └── 지지적관계: 부모의사소통, 부모학업지지, 친구정서지지, 교사정서지지
│
├── 학습 걸림돌 (학습 방해 요인) ⚠️ 낮을수록 좋음
│   ├── 학업스트레스: 성적부담, 공부부담, 수업부담
│   ├── 학습방해물: 스마트폰의존, 게임과몰입
│   └── 학업관계스트레스: 부모성적압력, 부모공부부담, 친구공부비교, 교사성적압력, 교사수업부담
│
├── 긍정적 공부마음 (내적 동기)
│   ├── 학업열의: 활기, 몰두, 의미감
│   └── 성장력: 자율성, 유능성, 관계성
│
└── 부정적 공부마음 (학업 소진) ⚠️ 낮을수록 좋음
    └── 학업소진: 고갈, 무능감, 반감냉소
```

### 2.3 T점수 해석 기준

| T점수 | 해석 | 긍정요인 | 부정요인 |
|-------|------|----------|----------|
| 65+ | 매우 높음 | 🟢 강점 | 🔴 위험 |
| 55~64 | 높음 | 🟢 양호 | 🟠 주의 |
| 45~54 | 보통 | ⚪ 평균 | ⚪ 평균 |
| 35~44 | 낮음 | 🟠 보완필요 | 🟢 양호 |
| ~34 | 매우 낮음 | 🔴 집중지원 | 🟢 강점 |

### 2.4 38개 요인 상세 (인덱스 순서)

```
[0] 자기존중감      [1] 자기효능감      [2] 성장마인드셋
[3] 자기정서인식    [4] 자기정서조절    [5] 타인정서인식    [6] 타인공감능력
[7] 계획능력        [8] 점검능력        [9] 조절능력
[10] 공부환경       [11] 시간관리       [12] 수업태도       [13] 노트하기       [14] 시험준비
[15] 부모의사소통   [16] 부모학업지지   [17] 친구정서지지   [18] 교사정서지지
[19] 활기           [20] 몰두           [21] 의미감
[22] 자율성         [23] 유능성         [24] 관계성
[25] 성적부담       [26] 공부부담       [27] 수업부담
[28] 스마트폰의존   [29] 게임과몰입
[30] 부모성적압력   [31] 부모공부부담   [32] 친구공부비교   [33] 교사성적압력   [34] 교사수업부담
[35] 고갈           [36] 무능감         [37] 반감냉소
```

---

## 3. LPA 유형 분류 시스템

### 3.1 LPA란?
**Latent Profile Analysis (잠재프로파일분석)**
- 38개 요인의 T점수 패턴이 유사한 학생들을 그룹화
- 각 그룹 = "유형" (Type/Profile)
- 유형별로 맞춤 개입전략 제공

### 3.2 유형 구성

#### 초등 (데이터 확보 완료 ✅)

| 유형 | 비율 | 색상 | 핵심 특징 |
|------|------|------|----------|
| **자원소진형** | 30.55% | 🟠 #F97316 | 심리자원 낮음, 스트레스 높음, 디지털 의존 위험 |
| **안전균형형** | 35.47% | 🔵 #14B8A6 | 전반적 균형, 점검능력(모니터링) 취약 |
| **몰입자원풍부형** | 33.98% | 🔷 #3351A4 | 내적 동기 높음, 시험전략 보완 필요 |

#### 중등 (데이터 대기 중 ⏳)

| 유형 | 비율 | 색상 | 핵심 특징 |
|------|------|------|----------|
| **무기력형** | 35.4% | 🟠 #F97316 | 심리/정서 자원 부족 |
| **정서조절취약형** | 38.0% | 🔵 #14B8A6 | 정서 스트레스 높음 |
| **자기주도몰입형** | 26.6% | 🔷 #3351A4 | 모든 자원 우수 |

### 3.3 LPA 분류 알고리즘 (4단계)

```
입력: 학생의 38개 T점수 + 학교급(초등/중등)

Step 1: 로그 우도 계산 (Log-Likelihood)
─────────────────────────────────────
각 유형별로 학생의 점수가 나올 확률 계산 (가우시안 분포 가정)
공식: log L = Σ[i=1~38] -0.5 × [(학생[i] - 유형평균[i])² / 100 + log(2π×100)]

Step 2: 사전확률 반영 (Bayes)
─────────────────────────────────────
유형별 출현 빈도 반영 (희귀 유형 과진단 방지)
공식: log P(유형|학생) = log L + log P(유형)

Step 3: Log-Sum-Exp 정규화
─────────────────────────────────────
수치 안정성 확보 + 확률 합 = 100%
max = max(log_posteriors)
prob = exp(log_post - max) / sum(exp) × 100

Step 4: 최대값 선택
─────────────────────────────────────
가장 높은 확률의 유형 = 예측 유형
그 확률값 = 확신도(confidence)

출력: { predictedType, confidence, allProbabilities }
```

### 3.4 유형별 T점수 중심값 (초등)

#### 자원소진형 (가장 힘든 그룹)
```
긍정적 자아:     자기존중감 38.1 | 자기효능감 37.9 | 성장마인드셋 37.2
학업열의:        활기 52.7 | 몰두 52.0 | 의미감 58.8
학업소진:        고갈 56.2 | 무능감 58.7 | 반감냉소 57.1
스마트폰의존:    57.4
부모성적압력:    50.0 (유형 중 가장 높음)
```

#### 안전균형형 (평균적인 그룹)
```
긍정적 자아:     자기존중감 52.0 | 자기효능감 50.9 | 성장마인드셋 50.7
메타인지:        계획능력 46.8 | 점검능력 45.5 | 조절능력 47.5
학업소진:        고갈 51.0 | 무능감 48.0 | 반감냉소 51.7
부모성적압력:    38.4 (낮음 - 좋음)
```

#### 몰입자원풍부형 (가장 잘하는 그룹)
```
긍정적 자아:     자기존중감 55.8 | 자기효능감 56.1 | 성장마인드셋 54.2
학업열의:        활기 66.4 | 몰두 63.8 | 의미감 74.9
학업소진:        고갈 45.5 | 무능감 45.4 | 반감냉소 43.2
시험준비:        52.95 (다른 요인 대비 상대적으로 낮음)
```

---

## 4. 핵심 인사이트 (상관분석 기반)

### 4.1 학업성취도와 가장 높은 상관

| 순위 | 요인 | 상관계수 | 의미 |
|------|------|----------|------|
| 1 | 유능성 | 0.520 | "나는 잘 할 수 있다" 느낌 |
| 2 | 자기효능감 | 0.490 | "노력하면 된다" 믿음 |
| 3 | 시험준비 | 0.480 | 시험 전략/기술 |
| 4 | 자기존중감 | 0.460 | "나는 괜찮은 사람" |
| 5 | 계획능력 | 0.445 | 학습 계획 수립 |

### 4.2 유형별 조절효과 (개입 전략의 핵심!)

#### 자원소진형 → 긍정완충 효과
```
자기효능감 × 자아존중감 → 학업성취도
효과: 긍정완충 (둘 다 높이면 오히려 효과 감소)
전략: 순차적 개입 - 효능감 먼저, 자존감은 나중에
이유: 동시 강화 시 심리적 부하 증가
```

#### 안전균형형 → 긍정강화 효과
```
시간관리 × 계획능력 → 학업성취도
효과: 긍정강화 (둘 다 높이면 시너지)
전략: 동시 개입 - 플래너 활용, 시간 블록 설계
이유: 계획과 시간관리가 결합되면 실행력 극대화
```

#### 몰입자원풍부형 → 직접효과
```
시험준비 → 학업성취도
효과: 직접효과 (조절변수 없이 직접 영향)
전략: 시험 전략 명시적 지도, 도전과제 제공
이유: 내적 동기는 높은데 시험 기술만 부족
```

### 4.3 위험 신호 기준

| 요인 | 위험 기준 | 관심 필요 |
|------|----------|----------|
| 학업소진(고갈) | T ≥ 65 | ⚠️ 번아웃 위험 |
| 무능감 | T ≥ 65 | ⚠️ 학습된 무기력 |
| 스마트폰의존 | T ≥ 65 | ⚠️ 디지털 과의존 |
| 부모성적압력 | T ≥ 65 | ⚠️ 가정 내 스트레스 |
| 자기존중감 | T ≤ 35 | ⚠️ 정서적 지원 필요 |

---

## 5. 6가지 핵심 기능 요구사항

### 요구사항 1: 대시보드 분리
```
Level 1: 교사 전체 반 대시보드 (Multi-Class)
    └── Level 2: 특정 반 대시보드 (Class)
            └── Level 3: 특정 학생 대시보드 (Student)
```

### 요구사항 2: 차수별 비교
- 1차(3월) vs 2차(9월) 검사 결과 비교
- 유형 변화 추적 (개선/악화/유지)
- 요인별 점수 변화 시각화

### 요구사항 3: 유형별 분포도
- 파이/도넛 차트로 시각화
- 클릭 시 해당 유형 학생 필터링
- 유형별 색상 일관성 유지

### 요구사항 4: 지식그래프 기반 개입 추천
- Neo4j 지식그래프 연동 (향후)
- 유형별 최적 개입 경로 제안
- X → Z → Y 형태의 경로 시각화

### 요구사항 5: PII 마스킹
- AI 에이전트에 학생 이름/학번/생년월일 전송 금지
- 학교급, 학년, 유형, T점수만 허용
- `piiMasking.ts` 유틸리티 사용

### 요구사항 6: 비바샘 연동
- 비바샘 플랫폼 내 임베드
- 브랜드 컬러 (#3351A4) 적용
- 상담기록/생활기록부 연동

---

## 6. 기술 스택

```
Frontend:     React 18 + TypeScript
Build:        Vite
Styling:      TailwindCSS
Charts:       Recharts
Router:       React Router v6
State:        React Context (추후 Zustand 고려)
AI:           Claude API (Anthropic)
Knowledge:    Neo4j (향후)
```

---

## 7. 파일 구조 가이드

```
meta-dashboard/
├── CLAUDE.md              # AI 코딩 스타일 가이드
├── PROJECT_CONTEXT.md     # 이 파일 (프로젝트 전체 컨텍스트)
├── docs/
│   ├── META_AI에이전트_기능정의서_v1.2.md  # 상세 기능 명세
│   ├── dashboard-design.md                 # 대시보드 UI 설계
│   ├── lpa_profile_data.json              # LPA 프로파일 데이터
│   └── lpa_classifier.js                  # LPA 알고리즘 참조 구현
├── prompts/
│   ├── system-prompt.md                   # AI 시스템 프롬프트
│   └── preset-*.md                        # 프리셋 프롬프트들
└── src/
    ├── data/
    │   ├── lpaProfiles.ts    # LPA 프로파일 (이 데이터가 핵심!)
    │   ├── factors.ts        # 38개 요인 정의
    │   └── mockData.ts       # 테스트용 목업 데이터
    ├── utils/
    │   ├── lpaClassifier.ts  # LPA 분류 알고리즘
    │   └── piiMasking.ts     # 개인정보 마스킹
    └── ...
```

---

## 8. 개발 우선순위

### Phase 1: 기본 대시보드 (현재)
- [x] 프로젝트 구조 설계
- [x] LPA 분류 알고리즘 구현
- [x] 타입 정의
- [ ] L1 대시보드 완성
- [ ] L2 대시보드 완성
- [ ] L3 대시보드 완성

### Phase 2: AI 연동
- [ ] AI 상담실 UI
- [ ] 프리셋 질문 기능
- [ ] 스트리밍 응답
- [ ] 생활기록부 문구 생성

### Phase 3: 고도화
- [ ] 지식그래프 연동 (Neo4j)
- [ ] 차수별 비교 애니메이션
- [ ] PDF 리포트 생성
- [ ] 비바샘 SSO 연동

---

## 9. 주의사항

### 🚨 절대 하면 안 되는 것
1. **학생 이름을 AI에 전송** → PII 마스킹 필수
2. **의학적 진단 라벨링** → "ADHD 의심" 등 금지
3. **유형을 단정적으로 표현** → "이 학생은 문제아" 금지
4. **부모/교사 비난** → "부모님이 문제" 금지

### ✅ 권장 사항
1. **강점 먼저 언급** → 긍정적 프레이밍
2. **구체적 T점수 인용** → 근거 기반
3. **실행 가능한 전략** → 교사가 바로 쓸 수 있게
4. **교사의 전문성 존중** → AI는 조언자 역할

---

## 10. 참고 자료

- `docs/META_AI에이전트_기능정의서_v1.2.md` - 상세 기능 정의
- `docs/dashboard-design.md` - UI 설계 문서
- `prompts/README.md` - AI 프롬프트 사용법
- `src/data/lpaProfiles.ts` - LPA 프로파일 원본 데이터

---

**Last Updated**: 2026-01-29
**Version**: 1.0
